<!DOCTYPE html>
<!--[if IE 7]>
<html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>
<html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US">  <!--<![endif]-->
<head>

    <title>Форма подачи заявки</title>

    <!-- META DATA -->
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <link href="css/style.css" rel="stylesheet">
  <link href="css/jquery.stepy.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet">

    <link rel="stylesheet" href="js/webix/webix.css" type="text/css">

    <!-- CSS Global Compulsory -->
    <link rel="stylesheet" href="req/css/bootstrap.min.css">
    <link rel="stylesheet" href="req/style.css">

    <!-- CSS Implementing Plugins -->
    <link rel="stylesheet" href="req/css/jquery.fullPage.css">
    <link rel="stylesheet" href="req/css/font-awesome.min.css">
    <link rel="stylesheet" href="req/css/ionicons.min.css">
    <link rel="stylesheet" href="req/css/animate.min.css">
    <link rel="stylesheet" href="req/css/flexslider.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <script src="req/js/respond.min.js"></script>
    <![endif]-->

    <!--[if lt IE 11]>
    <link rel="stylesheet" type="text/css" href="req/css/ie.css">
    <![endif]-->

    <!-- FONTS -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,700italic,400,300,700&amp;subset=latin,latin-ext'
          rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:100,200,300,400,700,900' rel='stylesheet'
          type='text/css'>

    <!-- JS -->
    <script type="text/javascript" src="req/js/modernizr.js"></script>

    <!-- FAVICONS -->
    <link rel="shortcut icon" href="req/images/favicon.ico">
    <link rel="apple-touch-icon" href="req/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="req/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="req/images/apple-touch-icon-114x114.png">

</head>
<body>

<!-- START PRELOADER -->
<div id="preloader">
    <div id="loading-animation">&nbsp;</div>
</div>
<!-- END PRELOADER -->

<!-- START SITE HEADER -->
<header class="site-header">
    <div class="site-logo onstart animated" data-animation="fadeInDown" data-animation-delay="1200">
        <h1>&nbsp;&nbsp;&nbsp;Форма подачи заявки на отдых</h1></div>

</header>
<!-- END SITE HEADER -->

<div id="fullpage">

    <!-- HOME SECTION -->
    <div class="section home active" id="section0">
        <!-- START CONTAINER -->
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1">
                    <!-- START SLIDE CONTENT-->
                    <div class="slide-content">
                        <div class="flexslider textslider onstart animated" data-animation="fadeInUp"
                             data-animation-delay="800">
                            <ul class="slides">
                                <li>
                                    <div class="box-widget">
                        <div class="widget-head clearfix">
                            <div id="top_tabby" class="block-tabby pull-left">
                            </div>
                        </div>
                        <div class="widget-container">
                            <div class="widget-block">
                                <div class="widget-content box-padding">
                                    <form id="stepy_form" role="form" class=" form-horizontal left-align form-well ">
                                        <fieldset title="Шаг 1">
                                            <legend>Информация о ребенке</legend>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Фамилия</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input required="true" class="form-control" id="fio" name="fio" type="text"/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Имя</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input required="true" class="form-control" id="name" name="name" type="text"/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Отчество</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input required="true" class="form-control" id="otch" name="otch" type="text"/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Дата рождения</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <div id="celdr"></div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Документ</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input required="true" class="form-control" id="doc" name="doc" type="text"/>
                                                    <span style="color: #444;" class="help-inline">Свидетельство о рождении/Паспорт</span>



                                                </div>
                                            </div>

                                        </fieldset>
                                        <fieldset title="Шаг 2">
                                            <legend>Информация о виде отдыха</legend>
                                            <div id="addcontract"></div>

                                        </fieldset>
                                        <fieldset title="Шаг 3">
                                            <legend>Информация о законном представителе</legend>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Отношение и ФИО</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input type="text" name="fiorod" id="fiorod" required="true" placeholder="" class="form-control">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Место работы</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input type="text" id="workstation" name="workstation" required="true" placeholder="" class="form-control">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-2 col-sm-2 control-label">Телефон</label>
                                                <div class="col-md-6 col-sm-6">
                                                    <input type="text" id="tel" placeholder="" name="tel" required="true" class="form-control">
                                                </div>
                                            </div>

                                        </fieldset>
                                        <button type="submit" onclick="senddata()" class="finish btn btn-info btn-extend"> Отправить!</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                                </li>

                            </ul>
                        </div>

                    </div>
                    <!-- END SLIDE CONTENT-->
                </div>
            </div>
            <!-- END ROW -->
        </div>
        <!-- END CONTAINER -->
    </div>


</div>


<!-- START VIEWPORT BORDER -->
<div class="viewport-border">
    <div class="vb-l"></div>
    <div class="vb-r"></div>
    <div class="vb-t"></div>
    <div class="vb-b"></div>
</div>
<!-- END VIEWPORT BORDER -->

<!-- OVERLAY -->
<div class="overlay">
    <div class="gradient-overlay gradient-1 opacity-100"></div>
</div>

<!-- JS -->
<script type="text/javascript" src="req/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="req/js/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="req/js/bootstrap.min.js"></script>
<script type="text/javascript" src="req/js/jquery.appear.js"></script>
<script type="text/javascript" src="req/js/jquery.easing.js"></script>
<script type="text/javascript" src="req/js/jquery.fullPage.min.js"></script>
<script type="text/javascript" src="req/js/jquery.backstretch.min.js"></script>
<script type="text/javascript" src="req/js/jquery.waitforimages.js"></script>
<script type="text/javascript" src="req/js/retina-1.1.0.min.js"></script>
<script type="text/javascript" src="req/js/jquery.countdown.js"></script>
<script type="text/javascript" src="req/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="req/js/jquery.mb.YTPlayer.js"></script>
<script type="text/javascript" src="req/js/jquery.ajaxchimp.js"></script>
<script type="text/javascript" src="req/js/jquery.placeholder.js"></script>
<script type="text/javascript" src="req/js/jquery.flexslider-min.js"></script>
<script type="text/javascript" src="req/js/waypoints.min.js"></script>
<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
<script type="text/javascript" src="req/js/main.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/jquery.stepy.js"></script>
<script src="js/modernizr.min.js"></script>
<script src="js/jquery.nicescroll.js"></script>
<script src="js/jquery-tags-input/jquery.tagsinput.js"></script>
<script src="js/tagsinput-init.js"></script>
<!--bootstrap input mask-->
<script type="text/javascript" src="js/bootstrap-inputmask/bootstrap-inputmask.min.js"></script>
<script src="js/webix/webix.js" type="text/javascript"></script>

<!--common scripts for all pages-->
<script src="js/scripts.js"></script>
<script>
    var gettimeobjcombo;
    var new_options;

    /*=====STEPY WIZARD WITH VALIDATION====*/
    $(function() {
        $('#stepy_form').stepy({
            backLabel: 'Назад',
            nextLabel: 'Вперед',
            errorImage: true,
            block: true,
            description: true,
            legend: false,
            titleClick: true,
            titleTarget: '#top_tabby',
            validate: true,
            finish:function(){
                return false;

            }

        }).validate({
            errorPlacement: function(error, element) {
                $('#stepy_form div.stepy-error').append(error);
            },
            rules: {
                'fio': 'required',
                'name': 'required',
                'otch': 'required',
                'dr': 'required',
				'doc':'required',
                'fiorod':'required',
                'workstation':'required',
                'tel':'required'
            },
            messages: {
                'name': {
                    required: 'Поле Имени обязательно'
                },
                'fio': {
                    required: 'Поле Фамилии обязательно'
                },
				'otch': {
                    required: 'Поле Отчества обязательно'
                },
                'dr': {
                    required: 'Поле Дня рождения обязательно'
                },
                'doc': {
                    required: 'Поле Документ обязательно'
                },
                'fiorod': {
                    required: 'Поле ФИО и отношение обязательно'
                },
                'workstation': {
                    required: 'Поле Место работы обязательно'
                },
                'tel': {
                    required: 'Поле Телефон обязательно'
                }

            }
        });
    });


    webix.ui({
        container:'celdr',
        width: 250,
        view:'datepicker',name:'date',id:'date',labelWidth:115,stringResult:true

    });


    function gid(eid){
        return document.getElementById(eid);
    }
    function senddata(){
        webix.ajax("insert/req.php?fio=" + gid('fio').value +
                "&name=" + gid('name').value +
                "&othc=" + gid('otch').value +
                "&date=" + $$('date').getValue() +
                "&doc=" + gid('doc').value +
                "&resttime=" + $$('get_all_kontraktcombo').getText() +
                "&resttimeobj=" + gettimeobjcombo +
                "&fiorod=" + gid('fiorod').value +
                "&workstation=" + gid('workstation').value +
                "&tel=" + gid('tel').value,
                {success:function(text){
                    if(text==1){
                    webix.alert({text:"Ваша заявкак отправлена"});
                    }else{
                        webix.alert({type:"alert-warning",text:"Повторите позже"});
                    }}},

                {error:function(text, data, XmlHttpRequest){
                    webix.alert({text:"Повторите позже"});
                }}
        );
    }
    webix.ready(function () {
        webix.ui({
            view: "form",
            container: "addcontract",
            scroll: false,
            width: 700,
            rows: [
                {
                    id: "get_all_whens",
                    label: "Выберите период",
                    labelWidth: 200,
                    view: "combo",
                    options: 'select/get_all_whens.php'
                },
                {
                    id: "get_all_kontraktcombo",
                    label: "Выберите лагер и смену",
                    labelWidth: 200,
                    hidden: true,
                    view: "combo",
                    options: []
                },
                {
                    id: "gettimeobjcombo",
                    label: "Выберите Смену",
                    view: "list",
                    width: 320,
                    hidden: true,
                    autoheight: true,
                    select: true,
                    on: {
                        onItemClick: function (id) {
                            gettimeobjcombo = this.getItem(id).value;

                        }
                    }
                }

            ]

        });
        $$("get_all_kontraktcombo").attachEvent("onChange", function () {
            var values = $$("get_all_kontraktcombo").getValue();
            $$("gettimeobjcombo").clearAll();
            gettimeobjcombo = null;
            $$("gettimeobjcombo").load("select/gettimeobj.php?idcontract=" + values);
            $$("gettimeobjcombo").show();
        });
        $$("get_all_whens").attachEvent("onChange", function () {
            var values = $$("get_all_whens").getValue();

            webix.ajax("select/get_all_kontraktcombo.php?vals=" + values, function (text, data) {
                new_options = data.json();
                var list = $$("get_all_kontraktcombo").getPopup().getList();
                list.clearAll();
                $$("get_all_kontraktcombo").setValue(" ");
                list.parse(new_options);
                $$("gettimeobjcombo").hide();

            });
            gettimeobjcombo = null;

            $$("get_all_kontraktcombo").show();
        });

    });

</script>
</body>
</html>