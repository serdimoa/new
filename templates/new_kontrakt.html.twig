{% extends "base.html" %} {% block title %}Новый контракт {% endblock %} {% block customheadjs %}

<script>
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split("=");
      if (pair[0] == variable) {
        return pair[1];
      }
    }
    return (false);
  }
</script>
{% endblock %} {% block nav %}

<ul class="nav nav-pills nav-stacked custom-nav">
  <li class="menu-list "><a href=""><i class="fa fa-home"></i> <span>Реестр детей</span></a>
    <ul class="sub-menu-list">
      <li><a href="index.php?np=good"><i class="fa fa-search"></i> <span>Обзор</span></a>
      </li>
      <li><a href="index.php?np=children_new"><i class="fa fa-plus"></i> <span>Добавить ребенка</span></a>
      </li>
    </ul>
  </li>
  <li><a href="index.php?np=request"><i class="fa fa-envelope"></i> <span>Реестр заявок</span></a>
  </li>
  <li class="menu-list nav-active"><a href=""><i class="fa fa-home"></i> <span>Контракты</span></a>
    <ul class="sub-menu-list">
      <li> <a href="index.php?np=kontrakt"><i class="fa fa-book"></i> <span>Обзор</span></a>
      </li>
      <li class="active"><a href="index.php?np=new_kontrakt"><i class="fa fa-plus"></i> <span>Добавить Контракт</span></a>
      </li>
    </ul>
  </li>
  <li><a id="Myunidf" href="index.html"><i class="fa fa-sign-out"></i> <span>Выход</span></a>
  </li>
</ul>
{% endblock %} {% block heading %}

<div class="page-heading">
  <h3>Добавление нового контракта</h3>
  <ul class="breadcrumb">
    <li><a href="good.html"> Реестр детей</a>
    </li>
    <li class="active">Добавление нового контракта</li>
  </ul>

</div>

{% endblock %} {% block content %}

<div class="row">
  <form role="form">

    <div class="col-md-6">
      <div class="row">
        <div class="col-md-12">

          <div class="panel">
            <header class="panel-heading">Информация о контракте </header>
            <div class="panel-body">
              <div class="profile-desk">
                  <div class="form-group">
                      <label for="resttype">Вид отдыха</label>

                      <div id="resttype"></div>
                  </div>
                <div class="form-group">
                  <label for="nameinp">Оздоровительное учереждение</label>
                  <input type="text" class="form-control" id="nameinp" required="">
                </div>
                <div class="form-group">
                  <label for="fioinp">Количество путевок</label>
                  <input type="number" class="form-control num" id="fioinp" required="">
                </div>
                <div class="form-group">
                  <label for="lastinp">Цена контракта</label>
                  <input type="number" class="form-control num" id="lastinp" required="">
                </div>
                <div class="form-group">
                  <label for="svid">Дней прибытия</label>
                  <input type="number" class="form-control num" id="svid" required="">
                </div>
                  <div class="form-group">
                      <label for="daysprice">Стоимость одного дня</label>
                      <input type="number" class="form-control" id="daysprice" required="">
                  </div>
                <div class="form-group">
                  <div id="celdr"></div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
    <div class="clearfix"></div>
    <div class="col-md-6">
      <div class="panel">
        <div class="panel-body">
          <div class="profile-desk">
            <div class="btn-group btn-group-justified">
              <a class="btn btn-success btn-lg" onclick="sendsave()">Добавить</a>
              <a class="btn btn-danger btn-lg" href="#">Отменить</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>

</div>
{% endblock %} {% block customjs %}


<script>
  webix.ready(function() {
    webix.ui({
      container: 'celdr',
      view: 'datepicker',
      name: 'date',
      id: 'date',
      labelWidth: 115,
      label: "Дата контракта",
      stringResult: true

    });
      webix.ui({
          container:'resttype',
          view:'combo',
          id:'resttypecombo',
          options:'select/resttypeall.php'
      });

  });
</script>
<script>
  function gid(eid) {
    return document.getElementById(eid);
  }


  function sendsave() {
    webix.ajax("insert/new_kontrakt_insert.php?nameinp=" + gid('nameinp').value +
      "&fioinp=" + gid('fioinp').value +
      "&lastinp=" + gid('lastinp').value +
      "&svid=" + gid('svid').value +
      "&daysprice=" + gid('daysprice').value +
            "&types="+$$('resttypecombo').getValue()+
      "&date=" + $$('date').getValue(), {
        success: function(text) {
          if (text == 0) {
            webix.alert({
              text: "Данные обновлены",
              callback: function() {
                document.location.href = "index.php?np=good";

              }
            });
          } else {
            webix.alert({
              type: "alert-warning",
              text: "Повторите позже",
              callback: function() {
                document.location.href = "index.php?np=good";

              }
            });
          }
        }
      },

      {
        error: function(text, data, XmlHttpRequest) {
          webix.alert({
            text: "Повторите позже"
          });
        }
      }
    );
  }
  gid('fioinp').onkeypress = function(e) {
    return !(/[А-Яа-яA-Za-z ]/.test(String.fromCharCode(e.charCode)));
  };
  gid('lastinp').onkeypress = function(e) {
    return !(/[А-Яа-яA-Za-z ]/.test(String.fromCharCode(e.charCode)));
  };
  gid('svid').onkeypress = function(e) {
    return !(/[А-Яа-яA-Za-z ]/.test(String.fromCharCode(e.charCode)));
  };
</script>
{% endblock %}
