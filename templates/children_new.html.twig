{% extends "base.html" %}

{% block title %}Регистрация ребенка в базе {% endblock %}
{% block customheadjs %}

<script>
        function getQueryVariable(variable)
        {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i=0;i<vars.length;i++) {
                var pair = vars[i].split("=");
                if(pair[0] == variable){return pair[1];}
            }
            return(false);
        }

    </script>
  {% endblock %}
{% block nav %}
<ul class="nav nav-pills nav-stacked custom-nav">
    <li class="menu-list nav-active"><a href=""><i class="fa fa-home"></i> <span>Реестр детей</span></a>
        <ul class="sub-menu-list">
            <li><a href="admin.php?np=good">Обзор</a></li>
            <li class="active"><a href="admin.php?np=children_new">Добавить ребенка</a></li>
        </ul>
    </li>
    <li><a href="admin.php?np=request"><i class="fa fa-envelope"></i> <span>Реестр заявок</span></a></li>
    <li class="menu-list "><a href=""><i class="fa fa-building-o"></i> <span>Контракты</span></a>
        <ul class="sub-menu-list">
            <li><a href="admin.php?np=kontrakt">Обзор</a></li>
            <li><a href="admin.php?np=new_kontrakt">Добавить Контракт</a></li>
        </ul>
    </li>
    <li><a id="Myunidf" href="/"><i class="fa fa-sign-out"></i> <span>Выход</span></a></li>
  </ul>
          {% endblock %}

{% block heading %}
        <div class="page-heading">
            <h3>Добавление нового ребенка</h3>
            <ul class="breadcrumb">
                <li><a href="good.html"> Реестр детей</a></li>
                <li class="active">Добавить ребенка</li>
            </ul>

        </div>
        {% endblock %}


{% block content %}
            <div class="row">
                <form role="form">

                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">

                            <div class="panel">
                                <header class="panel-heading">Информация о ребенке </header>
                                <div class="panel-body">
                                    <div class="profile-desk">

                                            
                                            <div class="form-group">
                                                <label for="fioinp">Фамилия</label>
                                                <input type="text" class="form-control" id="fioinp" required="">
                                            </div>
                                            <div class="form-group">
                                                <label for="nameinp">Имя</label>
                                                <input type="text" class="form-control" id="nameinp" required="">
                                            </div>
                                            <div class="form-group">
                                                <label for="lastinp">Отчество</label>
                                                <input type="text" class="form-control" id="lastinp" required="">
                                            </div>
                                        <div class="form-group">
                                            <label for="svid">Свидетельство о рождении / паспорт</label>
                                            <input type="text" class="form-control" id="svid" required="">
                                        </div>
                                            <div class="form-group">
                                                <div id="celdr"></div>
                                            </div>
                                        <div class="form-group">
                                            <label for="adrregs">Адрес регистрации</label>
                                            <input type="text" class="form-control" id="adrregs" required="">
                                        </div>
                                        <div class="form-group">
                                            <label for="adrfact">Адрес фактический</label>
                                            <input type="text" class="form-control" id="adrfact" required="">
                                        </div>
                                        <div class="form-group">
                                            <label for="scholl">Учебное заведение</label>
                                            <div id="scholl"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="classname">Класс</label>
                                            <input type="text" class="form-control" id="classname" required="">
                                        </div>



                                    </div>
                                </div>
                            </div>

                    </div>
                </div>

                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel">
                                <header class="panel-heading">Льготная категория </header>
                                <div class="panel-body">
                                    <div class="profile-desk">

                                        <div id="lgotkat"></div>
                                    </div>
                                    </div>
                                </div>

                            <div class="panel">
                                <header class="panel-heading">Информация о законном представителе </header>
                                <div class="panel-body">
                                    <div class="profile-desk">
                                        <label for="fioroditelya">Отношение и ФИО </label>
                                        <input type="text" class="form-control" id="fioroditelya">
                                    </div>
                                    <div class="profile-desk">
                                        <label for="workstation">Место работы </label>
                                        <input type="text" class="form-control" id="workstation">
                                    </div>

                                </div>
                            </div>
                            <div class="panel">
                                <header class="panel-heading">Контактные телефоны</header>
                                <div class="panel-body">
                                    <div class="profile-desk">
                                        <div class="form-group">
                                            <label for="rabotainp">Рабочий</label>
                                            <input type="text" class="form-control" id="rabotainp" >
                                        </div>
                                        <div class="form-group">
                                            <label for="homeinp">Домашний</label>
                                            <input type="text" class="form-control" id="homeinp" >
                                        </div>
                                        <div class="form-group">
                                            <label for="mobilinp">Сотовый</label>
                                            <input type="text" class="form-control" id="mobilinp" >
                                        </div>
                                        <div class="form-group">
                                            <label for="emailinp">Адресс электронной почти</label>
                                            <input type="text" class="form-control" id="emailinp">
                                        </div>
                                    </div>
                                </div>
                            </div>



                        </div>
                    </div>
                </div>
                    <div class="col-md-12">
                    <div class="panel">
                        <div class="panel-body">
                            <div class="profile-desk">
                                <div class="btn-group btn-group-justified">
                                    <a class="btn btn-success btn-lg" onclick="sendsave()" >Добавить</a>
                                    <a class="btn btn-danger btn-lg" onclick="window.history.back();" href="#">Отменить</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                </form>

            </div>
          {% endblock %}

{% block customjs %}


<script>
    webix.ready(function(){
        webix.ui({
            container:'celdr',
        view:'datepicker',name:'date',id:'date',labelWidth:115,label:'Дата рождения',stringResult:true

        });

        webix.ui({
            container:'scholl',
            view:'combo',
            id:'school',
            autowidth:true,
            autoheight:true,
            options:'select/scholl.php',
            type:{
                height:"auto",
                width:"auto"
            },
            fixedRowHeight:false
        });

        webix.ui({
           container:'lgotkat',
            view:'combo',
            id:'lgotkats',

            autowidth:true,
            options:'select/lgotkat.php',
            type:{
                height:"auto",
                width:"auto"
            },
            fixedRowHeight:false
        });



        });




</script>
<script>
    function gid(eid){
        var id = document.getElementById(eid);
        return id;
    }


    function sendsave(){
        webix.ajax("insert/children_new_insert.php?nameinp="      +   gid('nameinp').value +
                                "&fioinp="      +   gid('fioinp').value +
                                "&lastinp="     +   gid('lastinp').value +
                                "&svid="        +   gid('svid').value +
                                "&adrregs="     +   gid('adrregs').value +
                                "&adrfact="     +   gid('adrfact').value +
                                "&classname="   +   gid('classname').value +
                                "&fioroditelya="+   gid('fioroditelya').value +
                                "&workstation=" +   gid('workstation').value +
                                "&rabotainp="   +   gid('rabotainp').value +
                                "&homeinp="     +   gid('homeinp').value +
                                "&mobilinp="    +   gid('mobilinp').value +
                                "&emailinp="    +   gid('emailinp').value +
                                "&date="        +   $$('date').getValue() +
                                "&school="      +   $$('school').getValue() +
                                "&lgotkats="    +   $$('lgotkats').getValue(),
            {success:function(text){
                if(text==0){
                    webix.alert({text: "Данные добавлены", callback:function(){
                        document.location.href = "../admin.php";

                    }});
                }else{
                    webix.alert({type:"alert-warning",text:"Повторите позже",callback:function(){
                        document.location.href = "../admin.php";

                    }});
                }
            }},

            {error:function(text, data, XmlHttpRequest){
                webix.alert({text:"Повторите позже"});
            }}
        );
    }


</script>
{% endblock %}
