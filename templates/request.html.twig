{% extends "base.html" %}

{% block title %}Просмотр всех Заявок{% endblock %}

{% block nav %}

            <!--sidebar nav start-->
            <ul class="nav nav-pills nav-stacked custom-nav">
                <li class="menu-list"><a href=""><i class="fa fa-home"></i> <span>Реестр детей</span></a>
                    <ul class="sub-menu-list">
                        <li><a href="admin.php?np=good"><i class="fa fa-search"></i> <span>Обзор</span></a></li>
                        <li><a href="admin.php?np=children_new"><i class="fa fa-plus"></i> <span>Добавить ребенка</span></a>
                        </li>
                    </ul>
                </li>
                <li class="active"><a href="admin.php?np=request"><i class="fa fa-envelope"></i>
                        <span>Реестр заявок</span></a></li>
                <li class="menu-list "><a href=""><i class="fa fa-home"></i> <span>Контракты</span></a>
                    <ul class="sub-menu-list">
                        <li><a href="admin.php?np=kontrakt"><i class="fa fa-book"></i> <span>Обзор</span></a></li>
                        <li><a href="admin.php?np=new_kontrakt"><i class="fa fa-plus"></i>
                                <span>Добавить Контракт</span></a></li>
                    </ul>
                </li>
                <li><a id="Myunidf" href="index.html"><i class="fa fa-sign-out"></i> <span>Выход</span></a></li>

            </ul>
            <!--sidebar nav end-->
            {% endblock %}

            {% block heading %}

        <div class="page-heading">
            <h3>Список заявок</h3>
        </div>
        {% endblock %}


{% block content %}
        <div class="wrapper">
            <div class="row">
                <div id="datatbl" class="col-lg-12"></div>
            </div>
        </div>
        {% endblock %}

{% block customjs %}
<script>
    var jsonss;
    $.ajax({
        url: "select/selecttype.php", dataType: "json", success: function (data) {
            jsonss = data;
        }
    });
    function datajson(id) {
        var valse = jsonss[id - 1];
        valse = valse.valuers;
        return (valse);
    }
    webix.ready(function(){
        webix.ui({
            container:'datatbl',
            view:"datatable",
            id:"datatabl",
            onContext:{},
            columns:[
                {id:'id',header:['№']},
                {id:'status',header:['Статус'],sort:'string',template:function(obj){
                    switch (obj.status){
                        case "1":
                            return "В очереди";
                            break;
                        case "2":
                            return "Принято";
                            break;
                        case "3":
                            return "Отказано";
                            break;
                        case "4":
                            return "Исполнено";
                            break;
                        default :
                            return "В очереди";
                            break;
                    }
                }},
                {id:'year',header:['Год'],sort:'string'},
                {id:'date',header:['Дата'],sort:'string'},
                {id:'type',fillspace:true,header:['Направление'],sort:'string',template:function(obj){
                    var idrype = parseInt(obj.type);

                    return datajson(idrype);
                }},
                {id:'time',header:['Сроки'],sort:'string', width:150,template:function(obj){
                    switch (obj.time){
                        case "1":
                            return "Весенние каникулы";
                            break;
                        case "2":
                            return "Летние каникулы";
                            break;
                        case "3":
                            return "Осенние каникулы";
                            break;
                        case "4":
                            return "Зимние каникулы";
                            break;
                        default :
                            return "Заполнено не правильно";
                            break;

                    }
                }
                },
                {id:'timeobj',header:['Смена'],sort:'string',template:function(obj){
                    switch (obj.timeobj){
                        case "1":
                            return "1 Смена";
                            break;
                        case "2":
                            return "2 Смена";
                            break;
                        case "3":
                            return "3 Смена";
                            break;
                        case "4":
                            return "4 Смена";
                            break;
                        default :
                            return " ";
                            break;

                    }
                }
                }

            ],
            url:'select/get_req.php',autoheight:true,scrollX:false,select: 'row',on:{
            onSelectChange:function(){
                var selectedid = $$("datatabl").getSelectedId(true).join();

                document.location.href = "admin.php?np=profilereq&id=" + selectedid;
            }
            }


        });
        webix.ui({
            view:"contextmenu",
            id:"cmenu",
            data:["Просмотреть"],
            on:{
                onItemClick:function(id){
                    var context = this.getContext();
                    if(this.getItem(id).id=="Просмотреть")
                        document.location.href = "admin.php?np=profilereq&id=" + context.id;
                    else
                        webix.alert("error");


                }
            }
        });
        $$("cmenu").attachTo($$("datatabl"));
    });

</script>
{% endblock %}
